<title>设置我的密码</title>

<div class="layui-card layadmin-header">
  <div class="layui-breadcrumb" lay-filter="breadcrumb">
    <a lay-href="">主页</a>
    <a><cite>设置</cite></a>
    <a><cite>我的密码</cite></a>
  </div>
</div>
  
<div class="layui-fluid">
  <div class="layui-row layui-col-space15">
    <div class="layui-col-md12">
      <div class="layui-card">
        <div class="layui-card-header">修改密码</div>
        <div class="layui-card-body" pad15>
          
          <div class="layui-form" lay-filter="">
            <div class="layui-form-item">
              <label class="layui-form-label">当前密码</label>
              <div class="layui-input-inline">
                <input type="password" name="oldPassword" id="oldPassword" placeholder="请输入原密码" class="layui-input">
              </div>
            </div>
            <div class="layui-form-item">
              <label class="layui-form-label">新密码</label>
              <div class="layui-input-inline">
                <input type="password" name="password" id="newPassword" placeholder="请输入新密码"  class="layui-input">
              </div>
              <!-- <div class="layui-form-mid layui-word-aux">6到16个字符</div> -->
            </div>
            <div class="layui-form-item">
              <label class="layui-form-label">确认新密码</label>
              <div class="layui-input-inline">
                <input type="password" name="repassword" id="confirmPassword" placeholder="请确认新密码"  class="layui-input">
              </div>
            </div>
            <div class="layui-form-item">
              <div class="layui-input-block">
                <button class="layui-btn" id="sub" lay-submit lay-filter="setmypass">确认修改</button>
              </div>
            </div>
          </div>
          
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// layui.use('set', layui.factory('set'));.
layui.use(['form', 'laydate', 'layer'], function () {
		var form = layui.form;
		var laydate = layui.laydate;
     var $ = layui.$;
    //  getinfo();
    //  function getinfo(){
		// 			var parem={
		// 				channelNo:my_c_channel_no
		// 			}
		// 			$.ajax({
		// 				url: link+'/admin/domain/getInfo.do',
		// 				type: 'POST',
		// 				dataType: 'json',
		// 				data:parem,
		// 				success: function(res) {
		// 					if(res.code==0){
		// 						$('#name').val(res.data.name);
		// 						$('.oneurl').html(res.data.name);
		// 						$('.channe').html(my_c_channel_no);
		// 						$('#name1').val(res.data.name1);
		// 						form.render();
		// 					}
		// 				},
		// 				error: function () {
		// 					layer.msg('请求服务器失败！！')
		// 				}
		// 			});
    //  }
     $("#sub").click(function(){
					var that=this;
          var data={};
          data.channelNo=my_c_channel_no;
          data.account=localStorage.getItem("account");
          data.oldPassword=$('#oldPassword').val();
          data.newPassword=$('#newPassword').val();
          data.confirmPassword=$('#confirmPassword').val();
					var parem = JSON.stringify(data)
					var data={
						data:parem
					}
					$.ajax({
						url: link+'/admin/login/resetPassword.do',
						type: 'POST',
						dataType: 'json',
						data:data,
						success: function(res) {
							if (res.code==0) {
								layer.msg('保存成功', {
									icon: 1,
									time: 1000 //1秒关闭（如果不配置，默认是3秒）
								}, function () {
                  sessionStorage.clear();
                  localStorage.removeItem('newppqLogin')
                  location.hash = '/user/login'
							  });

							} else {
								layer.msg("提交失败：" + res.info, {
									icon: 2,
									time: 2000
								});

							}

								
						},
						error: function (jqXHR, textStatus, errorThrown) {
						/*错误信息处理*/
							layer.close(loadicon);
							layer.msg('请求失败，原因：' + errorThrown + ',状态码：' + jqXHR.status);


						}

					});
				})
    })
</script>