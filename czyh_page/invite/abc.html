<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<script type="text/javascript" src="./js/crypto-js.js" charset="UTF-8"></script>
		<script type="text/javascript" src="./js/jsencrypt.js" charset="UTF-8"></script>
		<script src="./js/rollups/aes.js" type="text/javascript" charset="utf-8"></script>
		<script src="./js/jquery-3.4.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="./js/http.js" type="text/javascript" charset="utf-8"></script>
	</head>

	<body>
		<div>
			加密前：<textarea id="source" value="" style="width:500px;height:90px;" /></textarea>
			<hr> 加密后：
			<textarea id="target" value="" style="width:500px;height:90px;"></textarea>
			<hr>
			<input type="button" onclick="test();" name="" value="加密" />
			<hr> 密文：
			<textarea id="sourceS" value="" width="400px" style="width:500px;height:90px;"></textarea>
			<hr> 解密后：
			<textarea id="jiemi" value="" style="width:500px;height:90px;"></textarea>
			<hr>
			<input type="button" onclick="test1();" name="" value="解密" />
		</div>

		<script type="text/javascript">
			http('/userSubordinate/invitePage', {
				token: 'aa974cb187c64e48ba603aaa753d6cbc'
			}).then(e => {
				console.log(e)
			})

			var key = 'gp7jX1Gn8W07ClvB7Di8kyD3';
			var iv = 'v3j!7X@-';
			//CBC模式加密
			function encryptByDESModeCBC(message) {
				var keyHex = CryptoJS.enc.Utf8.parse(key);
				var ivHex = CryptoJS.enc.Utf8.parse(iv);
				encrypted = CryptoJS.DES.encrypt(message, keyHex, {
					iv: ivHex,
					mode: CryptoJS.mode.CBC,
					padding: CryptoJS.pad.Pkcs7
				});
				return encrypted.ciphertext.toString();
			}
			//CBC模式解密
			function decryptByDESModeCBC(ciphertext2) {
				var keyHex = CryptoJS.enc.Utf8.parse(key);
				var ivHex = CryptoJS.enc.Utf8.parse(iv);
				console.log(CryptoJS.enc.Hex.parse(ciphertext2))
				console.log(CryptoJS.dec.Base64.parse(ciphertext2))
				// direct decrypt ciphertext
				var decrypted = CryptoJS.DES.decrypt({
					ciphertext: CryptoJS.enc.Base64.parse(ciphertext2)
				}, keyHex, {
					iv: ivHex,
					mode: CryptoJS.mode.CBC,
					padding: CryptoJS.pad.Pkcs7
				});
				return decrypted.toString(CryptoJS.enc.Utf8);
			}
			//DES ECB模式加密
			function encryptByDESModeEBC(message) {
				var keyHex = CryptoJS.enc.Utf8.parse(key);
				var encrypted = CryptoJS.DES.encrypt(message, keyHex, {
					mode: CryptoJS.mode.ECB,
					padding: CryptoJS.pad.Pkcs7
				});
				return encrypted.ciphertext.toString();
			}
			//DES ECB模式解密
			function decryptByDESModeEBC(ciphertext) {
				var keyHex = CryptoJS.enc.Utf8.parse(key);
				var decrypted = CryptoJS.DES.decrypt({
					ciphertext: CryptoJS.enc.Hex.parse(ciphertext)
				}, keyHex, {
					mode: CryptoJS.mode.ECB,
					padding: CryptoJS.pad.Pkcs7
				});
				var result_value = decrypted.toString(CryptoJS.enc.Utf8);
				return result_value;
			}

			function test() {
				var source = $("#source").val();
				var cc = encryptByDESModeCBC(CryptoJS.enc.Utf8.parse(source));
				$("#target").val(cc);
			}

			function test1() {
				var source = $("#sourceS").val();
				var dd = decryptByDESModeCBC(source);
				$("#jiemi").val(dd);
			}
		</script>
	</body>

</html>